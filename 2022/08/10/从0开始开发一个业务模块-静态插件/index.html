<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>CCFE技术博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="[toc] 本文档示例代码底座基于ccos-0.0.16-3版本:https:&#x2F;&#x2F;wiki.cestc.cn&#x2F;display&#x2F;architect&#x2F;v0.0.16-3 版本信息：  构建完成：2022-06-26 21:00 镜像地址：https:&#x2F;&#x2F;image.cestc.cn&#x2F;ccos-ceake&#x2F;ccos@sha256:77c92ef09c1e2fabd8959bba8023e6dfc9d9f">
<meta property="og:type" content="article">
<meta property="og:title" content="CCFE技术博客">
<meta property="og:url" content="http://example.com/2022/08/10/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9D%97-%E9%9D%99%E6%80%81%E6%8F%92%E4%BB%B6/index.html">
<meta property="og:site_name" content="CCFE技术博客">
<meta property="og:description" content="[toc] 本文档示例代码底座基于ccos-0.0.16-3版本:https:&#x2F;&#x2F;wiki.cestc.cn&#x2F;display&#x2F;architect&#x2F;v0.0.16-3 版本信息：  构建完成：2022-06-26 21:00 镜像地址：https:&#x2F;&#x2F;image.cestc.cn&#x2F;ccos-ceake&#x2F;ccos@sha256:77c92ef09c1e2fabd8959bba8023e6dfc9d9f">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/images/code%E4%BA%A7%E7%89%A9%E5%BA%93%E5%8F%98%E6%9B%B4.png">
<meta property="og:image" content="http://example.com/images/code-console-init.png">
<meta property="og:image" content="http://example.com/images/nav-entry.png">
<meta property="og:image" content="http://example.com/images/resourceType%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.jpeg">
<meta property="og:image" content="http://example.com/images/coderef.png">
<meta property="og:image" content="http://example.com/images/mock-error.png">
<meta property="og:image" content="http://example.com/images/6-%E5%8D%95%E6%B5%8B-%E6%9C%AC%E5%9C%B0.png">
<meta property="og:image" content="http://example.com/images/7-cypress-gui-1.png">
<meta property="og:image" content="http://example.com/images/7-cypress-gui.png">
<meta property="og:image" content="http://example.com/images/7-e2e-protractor.png">
<meta property="og:image" content="http://example.com/images/protractor-%E8%B0%83%E8%AF%95.png">
<meta property="og:image" content="http://example.com/images/7-e2e-protractor-sucess.png">
<meta property="og:image" content="http://example.com/images/e2e-fixed-entry.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E6%9E%84%E5%BB%BA%E6%88%90%E5%8A%9F.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%801.png">
<meta property="og:image" content="http://example.com/images/%E9%83%A8%E7%BD%B21-0.png">
<meta property="og:image" content="http://example.com/images/%E9%83%A8%E7%BD%B21.png">
<meta property="og:image" content="http://example.com/images/%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%88%90.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF-UT-%E6%88%90%E5%8A%9F.png">
<meta property="og:image" content="http://example.com/images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF-E2E-%E6%88%90%E5%8A%9F.png">
<meta property="og:image" content="http://example.com/images/demo-list.png">
<meta property="og:image" content="http://example.com/images/demo-detail-info.png">
<meta property="og:image" content="http://example.com/images/demo-detail-yaml.png">
<meta property="og:image" content="http://example.com/images/demo-notice.png">
<meta property="article:published_time" content="2022-08-10T06:12:45.196Z">
<meta property="article:modified_time" content="2022-08-10T06:12:45.196Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/images/code%E4%BA%A7%E7%89%A9%E5%BA%93%E5%8F%98%E6%9B%B4.png">
  
    <link rel="alternate" href="/atom.xml" title="CCFE技术博客" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">CCFE技术博客</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-从0开始开发一个业务模块-静态插件" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/08/10/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9D%97-%E9%9D%99%E6%80%81%E6%8F%92%E4%BB%B6/" class="article-date">
  <time class="dt-published" datetime="2022-08-10T06:12:45.196Z" itemprop="datePublished">2022-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>[toc]</p>
<p>本文档示例代码底座基于ccos-0.0.16-3版本:<a target="_blank" rel="noopener" href="https://wiki.cestc.cn/display/architect/v0.0.16-3">https://wiki.cestc.cn/display/architect/v0.0.16-3</a></p>
<p>版本信息：</p>
<blockquote>
<p><strong>构建完成：</strong>2022-06-26 21:00</p>
<p><strong>镜像地址：</strong><a target="_blank" rel="noopener" href="https://image.cestc.cn/ccos-ceake/ccos@sha256:77c92ef09c1e2fabd8959bba8023e6dfc9d9f3dda7aaeaa93bf128e348c73011">https://image.cestc.cn/ccos-ceake/ccos@sha256:77c92ef09c1e2fabd8959bba8023e6dfc9d9f3dda7aaeaa93bf128e348c73011</a> </p>
<p><strong>ISO地址：</strong>\<a target="_blank" rel="noopener" href="http://samba.cestc.cn/">samba.cestc.cn</a>\CEStack版本发布-浏览权限\ccos_etc\iso\cclinux\x86_64\CCLinux-2203-rc1-x86_64-dvd1.iso</p>
<p><strong>安装脚本：</strong>\<a target="_blank" rel="noopener" href="http://samba.cestc.cn/">samba.cestc.cn</a>\CEStack版本发布-浏览权限\ccos_etc\ccos_new\system_0.0.16-3.tar.gz</p>
</blockquote>
<h2 id="一、创建仓库，初始化模块代码"><a href="#一、创建仓库，初始化模块代码" class="headerlink" title="一、创建仓库，初始化模块代码"></a>一、创建仓库，初始化模块代码</h2><p>通过邮件申请，在ccos&#x2F;console-module的subgroup下新建console-module-{模块名称}的功能模块仓库。</p>
<p>仓库创建成功后，参考<a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-demo/-/tree/master">console-module-demo</a>,至少修改package.json的<code>name</code>后，推送到远程</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;@console/module-mariadbs&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0-fixed&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mariadbs&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;private&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;scripts&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;test&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yarn --cwd ../.. test packages/console-module-mariadbs&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;dependencies&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;@console/internal&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0-fixed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@console/plugin-sdk&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0-fixed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@console/internal-integration-tests&quot;</span><span class="punctuation">:</span><span class="string">&quot;0.0.0-fixed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;@console/shared&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.0.0-fixed&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;consolePlugin&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;entry&quot;</span><span class="punctuation">:</span> <span class="string">&quot;src/plugin.tsx&quot;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h2 id="二、项目引入初始化"><a href="#二、项目引入初始化" class="headerlink" title="二、项目引入初始化"></a>二、项目引入初始化</h2><h3 id="1-xx-image产物库初始化"><a href="#1-xx-image产物库初始化" class="headerlink" title="1.  xx-image产物库初始化"></a>1.  xx-image产物库初始化</h3><p>以CeaKE产品的<a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/cea/ceake-release/-/commit/91f049f3bc1866410feaa86cddef5edd279751af">ceake-release</a>产物库为例，新增一行对console-module-{模块名称}的引用：</p>
<p>目的：在后续cdp流水线使用时产物库的组装。</p>
<p><img src="/./images/code%E4%BA%A7%E7%89%A9%E5%BA%93%E5%8F%98%E6%9B%B4.png"></p>
<p>切分支：</p>
<p>将需要用到的组件都切换到feature-lesson-ma的分支上。</p>
<h3 id="2-console项目初始化"><a href="#2-console项目初始化" class="headerlink" title="2. console项目初始化"></a>2. console项目初始化</h3><p><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console/-/merge_requests/114/diffs#e615b43a4e596d2e2843c7e99d4b96d025236bf0">console</a></p>
<h4 id="1-frontend-x2F-plugin-list文件同步"><a href="#1-frontend-x2F-plugin-list文件同步" class="headerlink" title="1. frontend&#x2F;plugin.list文件同步"></a>1. frontend&#x2F;plugin.list文件同步</h4><p>为了方便在本地开发调试，我们在<code>frontend/plugin.list</code>文件里写入与产物库一样的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ccos/console-module/kubevirt-plugin</span><br><span class="line">ccos/console-module/console-module-ceake</span><br><span class="line">ccos/console-module/console-module-mariadbs</span><br></pre></td></tr></table></figure>

<h4 id="2-本地起项目"><a href="#2-本地起项目" class="headerlink" title="2. 本地起项目"></a>2. 本地起项目</h4><h4 id="2-1-前置准备"><a href="#2-1-前置准备" class="headerlink" title="2.1 前置准备"></a>2.1 前置准备</h4><h5 id="2-1-1-绑定hosts"><a href="#2-1-1-绑定hosts" class="headerlink" title="2.1.1  绑定hosts"></a>2.1.1  绑定hosts</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">10.253.24.134 api-int.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 api.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 console-openshift-console.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 oauth-openshift.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 grafana-openshift-monitoring.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 thanos-querier-openshift-monitoring.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 prometheus-k8s-openshift-monitoring.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 alertmanager-main-openshift-monitoring.apps.cc-openshift2.ccos.test</span><br><span class="line">10.253.24.134 notification.apps.cc-openshift2.ccos.test</span><br></pre></td></tr></table></figure>

<h5 id="2-1-2-组装运行时目录"><a href="#2-1-2-组装运行时目录" class="headerlink" title="2.1.2 组装运行时目录"></a>2.1.2 组装运行时目录</h5><p>将frontend&#x2F;init-frontend.sh的srcBranch字段修改为当前的分支名</p>
<p><img src="/./images/code-console-init.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd frontend</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">第一次运行执行、组装目录</span></span><br><span class="line">./init-frontend.sh</span><br></pre></td></tr></table></figure>



<h4 id="2-2-本地运行项目"><a href="#2-2-本地运行项目" class="headerlink" title="2.2 本地运行项目"></a>2.2 本地运行项目</h4><h5 id="2-2-1-起后端"><a href="#2-2-1-起后端" class="headerlink" title="2.2.1 起后端"></a>2.2.1 起后端</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">到console目录下登录</span></span><br><span class="line">cd ../ </span><br><span class="line"></span><br><span class="line">oc login https://console-openshift-console.apps.cc-openshift2.ccos.test:6443 -u kubeadmin -p SQg6s-PGTwo-eGGbf-mbWdT</span><br><span class="line"></span><br><span class="line">source ./contrib/oc-environment.sh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">起go server: go 调试模式</span></span><br><span class="line">go run ./cmd/bridge/main.go --k8s-mode=off-cluster --k8s-mode-off-cluster-notification=https://notification.apps.cc-openshift2.ccos.test -- k8s-mode-off-cluster-skip-verify-tls=true</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">起go server: 不调试go代码，只起项目</span></span><br><span class="line">./build-backend.sh</span><br><span class="line">./bin/bridge</span><br></pre></td></tr></table></figure>

<h5 id="2-2-2-起前端"><a href="#2-2-2-起前端" class="headerlink" title="2.2.2 起前端"></a>2.2.2 起前端</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd frontend &amp;&amp; yarn</span><br><span class="line">yarn run dev</span><br></pre></td></tr></table></figure>

<h5 id="2-2-3-访问页面-http-localhost-9000"><a href="#2-2-3-访问页面-http-localhost-9000" class="headerlink" title="2.2.3 访问页面: http://localhost:9000/"></a>2.2.3 访问页面: <a target="_blank" rel="noopener" href="http://localhost:9000/">http://localhost:9000/</a></h5><h3 id="3-产品导航栏新增入口"><a href="#3-产品导航栏新增入口" class="headerlink" title="3. 产品导航栏新增入口"></a>3. 产品导航栏新增入口</h3><p><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-ceake/-/merge_requests/8/diffs">console-module-ceake</a></p>
<p><img src="/./images/nav-entry.png"></p>
<h2 id="三、编码实现"><a href="#三、编码实现" class="headerlink" title="三、编码实现"></a>三、编码实现</h2><p>代码库：<a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-mariadbs/-/tree/feature-lesson-ma">console-module-mariadbs</a></p>
<h3 id="1-package-json"><a href="#1-package-json" class="headerlink" title="1. package.json"></a>1. package.json</h3><p>package.json的编辑规则:</p>
<blockquote>
<ol>
<li>name：以<code>@console/</code>为前缀</li>
<li>version：<code>0.0.0-fixed</code></li>
<li>consolePlugin： <ul>
<li>entry：静态插件内需要导出的入口模块</li>
<li>integrationTestSuites： 以[key]:value的形式暴露给console框架的protractor E2E测试用例，最终会被protractor.config.ts里的config.suites识别到。 [key]就是执行标识。</li>
</ul>
</li>
<li>scripts, dependencies, devDependencies自行定义即可</li>
</ol>
</blockquote>
<h3 id="2-console-extension-json与plugin-tsx"><a href="#2-console-extension-json与plugin-tsx" class="headerlink" title="2. console-extension.json与plugin.tsx"></a>2. console-extension.json与plugin.tsx</h3><p>content-extension.js的编辑规则及 plugin.tsx编辑规则：<a target="_blank" rel="noopener" href="https://wiki.cestc.cn/pages/viewpage.action?pageId=161564444">type定义——console-extensions.json编辑指引</a></p>
<p>content-extension.js与plugin.tsx互补，会merge后被console框架工程引入。</p>
<p>以列表页和详情页为例，对应关系：</p>
<p><img src="/./images/resourceType%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB.jpeg"></p>
<h3 id="3-定义model和yaml-templates"><a href="#3-定义model和yaml-templates" class="headerlink" title="3. 定义model和yaml templates"></a>3. 定义model和yaml templates</h3><h5 id="3-1-model定义"><a href="#3-1-model定义" class="headerlink" title="3. 1 model定义"></a>3. 1 model定义</h5><p>用于描述资源类型和基本属性，可以从接口获取。所在文件<code>console-module-mariadbs/src/models.ts</code></p>
<h6 id="3-1-1-定义"><a href="#3-1-1-定义" class="headerlink" title="3.1.1 定义"></a>3.1.1 定义</h6><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title class_">MariaDBModel</span>: K8sKind = &#123;</span><br><span class="line">  <span class="attr">kind</span>: <span class="string">&#x27;MariaDB&#x27;</span>,</span><br><span class="line">  <span class="attr">plural</span>: <span class="string">&#x27;mariadbs&#x27;</span>,</span><br><span class="line">  <span class="attr">apiVersion</span>: <span class="string">&#x27;v1alpha1&#x27;</span>,</span><br><span class="line">  <span class="attr">apiGroup</span>: <span class="string">&#x27;db.cloud.cestc.cn&#x27;</span>,</span><br><span class="line">  <span class="attr">labelPlural</span>: <span class="string">&#x27;MariaDBs&#x27;</span>,</span><br><span class="line">  <span class="attr">labelPluralKey</span>: <span class="string">&#x27;console-module-mariadbs~MariaDBs&#x27;</span>,</span><br><span class="line">  <span class="attr">label</span>: <span class="string">&#x27;MariaDB&#x27;</span>,</span><br><span class="line">  <span class="attr">labelKey</span>: <span class="string">&#x27;console-module-mariadbs~MariaDB&#x27;</span>,</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&#x27;mariadbs&#x27;</span>,</span><br><span class="line">  <span class="attr">crd</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">namespaced</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">abbr</span>: <span class="string">&#x27;MDB&#x27;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h6 id="3-1-2-导出"><a href="#3-1-2-导出" class="headerlink" title="3.1.2 导出"></a>3.1.2 导出</h6><p>在plugin.tsx文件里</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;ModelDefinition&#x27;</span>,</span><br><span class="line">  <span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">models</span>: [<span class="title class_">MariaDBModel</span>],</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>



<h5 id="3-2-yaml-templates定义"><a href="#3-2-yaml-templates定义" class="headerlink" title="3.2 yaml templates定义"></a>3.2 yaml templates定义</h5><p>用于以yaml的语法在页面内创建、修改mariadb资源的初始化模板，需要找资源后端获取。所在文件：<code>console-module-mariadbs/src/yaml-templates.ts</code></p>
<h6 id="3-2-1-定义"><a href="#3-2-1-定义" class="headerlink" title="3.2.1 定义"></a>3.2.1 定义</h6><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> yamlTemplates = <span class="title class_">ImmutableMap</span>().<span class="title function_">setIn</span>(</span><br><span class="line">  [<span class="title class_">MariaDBModel</span>, <span class="string">&#x27;default&#x27;</span>],</span><br><span class="line">  <span class="string">`</span></span><br><span class="line"><span class="string">apiVersion: <span class="subst">$&#123;MariaDBModel.apiGroup&#125;</span>/<span class="subst">$&#123;MariaDBModel.apiVersion&#125;</span></span></span><br><span class="line"><span class="string">kind: <span class="subst">$&#123;MariaDBModel.kind&#125;</span></span></span><br><span class="line"><span class="string">metadata:</span></span><br><span class="line"><span class="string">  name: example</span></span><br><span class="line"><span class="string">spec:</span></span><br><span class="line"><span class="string">  managementState: Managed</span></span><br><span class="line"><span class="string">  replicas: 1</span></span><br><span class="line"><span class="string">  username: Tahathj=</span></span><br><span class="line"><span class="string">  password: MTIzNDU2Cg==</span></span><br><span class="line"><span class="string">  database: employees</span></span><br><span class="line"><span class="string">  rootPwd: MTIzNDU2Cg==</span></span><br><span class="line"><span class="string">  image: mariadb:10.7.4</span></span><br><span class="line"><span class="string">  port: 30306</span></span><br><span class="line"><span class="string">`</span>,</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h6 id="3-2-3-导出"><a href="#3-2-3-导出" class="headerlink" title="3.2.3 导出"></a>3.2.3 导出</h6><p>在content-extension.json里</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;console.yaml-template&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;properties&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">     <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;default&quot;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;group&quot;</span><span class="punctuation">:</span> <span class="string">&quot;db.cloud.cestc.cn&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;kind&quot;</span><span class="punctuation">:</span> <span class="string">&quot;MariaDB&quot;</span><span class="punctuation">,</span></span><br><span class="line">       <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;v1alpha1&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">     <span class="attr">&quot;template&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">       <span class="attr">&quot;$codeRef&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yamlTemplates.defaultYamlTemplate&quot;</span></span><br><span class="line">     <span class="punctuation">&#125;</span></span><br><span class="line">   <span class="punctuation">&#125;</span></span><br><span class="line"> <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<p>其中，package.json需要对$codeRef增加导出描述</p>
<p><img src="/./images/coderef.png"></p>
<h3 id="4-mariadbs列表页"><a href="#4-mariadbs列表页" class="headerlink" title="4. mariadbs列表页"></a>4. mariadbs列表页</h3><p>新建文件<code>mariadb.tsx</code>，复用ListPage、Table组件编码。</p>
<p>在<code>plugin.tsx</code>里导出列表页(列表页最终会作为<code>/public/components/resource-pages.ts</code>的baseListPages的扩展被加载)：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="string">&#x27;Page/Resource/List&#x27;</span>,</span><br><span class="line">  <span class="attr">properties</span>: &#123;</span><br><span class="line">    <span class="attr">model</span>: <span class="title class_">MariaDBModel</span>,</span><br><span class="line">    <span class="attr">loader</span>: <span class="function">() =&gt;</span></span><br><span class="line">      <span class="title function_">import</span>(<span class="string">&#x27;./components/mariadb&#x27;</span> <span class="comment">/* webpackChunkName: &quot;mariadb&quot; */</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">m</span>) =&gt;</span> m.<span class="property">MariaDBPage</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="5-mariadbs详情页"><a href="#5-mariadbs详情页" class="headerlink" title="5. mariadbs详情页"></a>5. mariadbs详情页</h3><p>新建文件<code>mariadb-detail.tsx</code>， 复用DetailsPage、navFactory组件编码。</p>
<p>在<code>plugin.tsx</code>里导出列表页(列表页最终会作为<code>/public/components/resource-pages.ts</code>的baseDetailsPages的扩展被加载)：</p>
<figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">type</span>: <span class="string">&#x27;Page/Resource/Details&#x27;</span>,</span><br><span class="line">   <span class="attr">properties</span>: &#123;</span><br><span class="line">     <span class="attr">model</span>: <span class="title class_">MariaDBModel</span>,</span><br><span class="line">     <span class="attr">loader</span>: <span class="function">() =&gt;</span></span><br><span class="line">       <span class="title function_">import</span>(<span class="string">&#x27;./components/mariadb-detail&#x27;</span> <span class="comment">/* webpackChunkName: &quot;mariadb&quot; */</span>).<span class="title function_">then</span>(</span><br><span class="line">         <span class="function">(<span class="params">m</span>) =&gt;</span> m.<span class="property">MariaDBDetailsPage</span>,</span><br><span class="line">       ),</span><br><span class="line">   &#125;,</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>



<h3 id="6-notification列表-微服务"><a href="#6-notification列表-微服务" class="headerlink" title="6. notification列表-微服务"></a>6. notification列表-微服务</h3><p>新建<code>notice-table.tsx</code>。列表复用Table组件</p>
<p>页面内异步请求接口复用coFetchJSON封装。在进入页面时发起请求：</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">React</span>.<span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123; </span><br><span class="line">     <span class="title function_">coFetchJSON</span>(<span class="string">&#x27;/api/notification/api/v1/notices&#x27;</span>)</span><br><span class="line">     .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="title function_">setData</span>(res.<span class="property">Notices</span>);</span><br><span class="line">       <span class="title function_">setLoading</span>(<span class="literal">false</span>)</span><br><span class="line">       <span class="title function_">setError</span>(<span class="literal">false</span>)</span><br><span class="line">     &#125;)</span><br><span class="line">     .<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">error</span>(e);</span><br><span class="line">       <span class="title function_">setLoading</span>(<span class="literal">false</span>)</span><br><span class="line">       <span class="title function_">setError</span>(<span class="literal">true</span>)</span><br><span class="line">     &#125;); </span><br><span class="line"> &#125;, []);</span><br></pre></td></tr></table></figure>

<p>自定义接口请求逻辑需要对接口出错、异常做兼容处理。推荐使用<code>&lt;LoadError&gt;</code>组件、提供在出错时点击重试的功能。效果：</p>
<p><img src="/./images/mock-error.png"></p>
<h3 id="7-UT开发、调试"><a href="#7-UT开发、调试" class="headerlink" title="7. UT开发、调试"></a>7. UT开发、调试</h3><h5 id="本地开发："><a href="#本地开发：" class="headerlink" title="本地开发："></a>本地开发：</h5><p>在src目录下新建<code>__tests__</code>目录，新建<code>k8s-models.spec.ts</code>文件，在文件内写单测用例即可。</p>
<h5 id="本地调试："><a href="#本地调试：" class="headerlink" title="本地调试："></a>本地调试：</h5><p>命令行：（在console目录下）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">对console-module-mariadbs目录下所有文件的单测</span></span><br><span class="line">yarn run test frontend/packages/console-module-mariadbs</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">对单个文件调试</span></span><br><span class="line">yarn run test frontend/packages/console-module-mariadbs/src/__tests__/k8s-models.spec.ts</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">test</span>全部</span></span><br><span class="line">yarn run test</span><br></pre></td></tr></table></figure>

<p>本地调试单个文件，调试结果：</p>
<p><img src="/./images/6-%E5%8D%95%E6%B5%8B-%E6%9C%AC%E5%9C%B0.png"></p>
<h5 id="流水线执行："><a href="#流水线执行：" class="headerlink" title="流水线执行："></a>流水线执行：</h5><p>console框架代码里不需要添加执行入口。</p>
<h3 id="8-E2E开发、调试"><a href="#8-E2E开发、调试" class="headerlink" title="8. E2E开发、调试"></a>8. E2E开发、调试</h3><h4 id="Cypress"><a href="#Cypress" class="headerlink" title="Cypress"></a>Cypress</h4><h5 id="本地开发：-1"><a href="#本地开发：-1" class="headerlink" title="本地开发："></a>本地开发：</h5><p>在与src平级的目录下新建integration-tests-cypress目录，结构内容如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">├── cypress-a11y-report.json</span><br><span class="line">├── cypress.json</span><br><span class="line">├── reporter-config.json</span><br><span class="line">├── support</span><br><span class="line">│   └── index.ts</span><br><span class="line">├── tests</span><br><span class="line">│   └── mariadbs.spec.ts // 测试用例-一个具体的场景（例如： 对mariadbs的增删改查操作）</span><br><span class="line">├── tsconfig.json</span><br><span class="line">└── views</span><br><span class="line">    └── mariadbs.view.ts</span><br></pre></td></tr></table></figure>

<p><strong>说明：一个完整的E2E用例应该包含资源实例的增删改查全流程，在测试完成后，应当将测试的测试删除掉。</strong></p>
<p><span style="color:red">console框架代码里需要添加执行入口</span></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// package.json的scripts</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">	  <span class="attr">&quot;test-cypress-mariadbs&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cd packages/console-module-mariadbs/integration-tests-cypress &amp;&amp; ../../../node_modules/.bin/cypress open --env openshift=true&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;test-cypress-mariadbs-headless&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cd packages/console-module-mariadbs/integration-tests-cypress &amp;&amp; node --max-old-space-size=4096 ../../../node_modules/.bin/cypress run --env openshift=true --browser $&#123;BRIDGE_E2E_BROWSER_NAME:=chrome&#125; --headless&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="本地调试：-1"><a href="#本地调试：-1" class="headerlink" title="本地调试："></a>本地调试：</h5><p>本地开发调试-GUI模式</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">GUI模式</span></span><br><span class="line">cd frontend &amp;&amp; yarn run test-cypress-mariadbs</span><br></pre></td></tr></table></figure>

<p><img src="/./images/7-cypress-gui-1.png"></p>
<p>本地开发调试-纯命令行headless模式</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">headless命令行模式</span></span><br><span class="line">cd frontend &amp;&amp; yarn run test-cypress-mariadbs-headless</span><br></pre></td></tr></table></figure>

<p><img src="/./images/7-cypress-gui.png"></p>
<h4 id="Protractor"><a href="#Protractor" class="headerlink" title="Protractor"></a>Protractor</h4><h5 id="本地开发：-2"><a href="#本地开发：-2" class="headerlink" title="本地开发："></a>本地开发：</h5><ol>
<li>用例文件新增</li>
</ol>
<p>在与src平级目录下新增integration-tests目录，tests目录下新建文件：<code>mariadb.scenario.ts</code>。在文件里写对应的增删改查自测逻辑即可。</p>
<ol start="2">
<li>package.json的”consolePlugin”新增</li>
</ol>
<p><img src="/./images/7-e2e-protractor.png"></p>
<h5 id="本地调试：-2"><a href="#本地调试：-2" class="headerlink" title="本地调试："></a>本地调试：</h5><p>在源码的js语句里写debugger打断点，然后根据场景、以下指令2选1执行：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">方法1： 对http://localhost:9000/的页面做E2E测试</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./local-test-protractor-localhost.sh mariadbs</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">方法2： 对http://console-ccos-console.apps.cc-ccos2.ccos.test 环境上的页面做E2E测试</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">./local-test-protractor.sh mariadbs</span></span><br></pre></td></tr></table></figure>

<p>然后打开chrome浏览器，访问<a href="chrome://inspect/#devices">chrome:&#x2F;&#x2F;inspect&#x2F;#devices</a> 打开浏览器即可边debugger边写用例了</p>
<p><img src="/./images/protractor-%E8%B0%83%E8%AF%95.png"></p>
<p><img src="/./images/7-e2e-protractor-sucess.png"></p>
<h4 id="流水线执行：-1"><a href="#流水线执行：-1" class="headerlink" title="流水线执行："></a>流水线执行：</h4><p>分为两种：</p>
<ol>
<li>通用功能：需要加到主流程里的E2E测试用例</li>
</ol>
<blockquote>
<p> 一个通用的功能，在页面内一定会有入口。那么可以在<code>test-prow-e2e.sh</code>里，加上对应逻辑，流水线不用做任何更改。根据自己的技术栈二选一即可。</p>
</blockquote>
<p><img src="/./images/e2e-fixed-entry.png"></p>
<ol start="2">
<li>定制功能：不能加到主流程里的非通用E2E测试用例</li>
</ol>
<blockquote>
<p>例如：kubevirt-plugin-虚拟化的功能，对于ccos底座来说不是每个产品必备的功能，是在一定条件下才出现在console侧边栏的功能。因此，kubevirt-plugin的E2E测试用例建议单独起一个流程用单独的测试去跑。</p>
<p>需要自己新建流水线。</p>
</blockquote>
<p>代码参考：test-prow-e2e-kubevirt.sh</p>
<p>流水线参考：<a target="_blank" rel="noopener" href="https://cdp.cestc.cn/product/#/project/pipeline/result?projectId=1524581341446340610&pipelineId=1538829184330620929">kubevirt前端测试流水线</a></p>
<h3 id="9-国际化"><a href="#9-国际化" class="headerlink" title="9. 国际化"></a>9. 国际化</h3><p>页面内所有涉及到文案必须在<code>frontend/packages/console-module-mariadbs/locales</code>的zh和en文件里定义对应翻译。</p>
<p>编码实现完成后，准备构建镜像，部署到环境验证、自测。</p>
<h2 id="四、流水线使用"><a href="#四、流水线使用" class="headerlink" title="四、流水线使用"></a>四、流水线使用</h2><h3 id="1-前端镜像单独构建部署"><a href="#1-前端镜像单独构建部署" class="headerlink" title="1. 前端镜像单独构建部署"></a>1. 前端镜像单独构建部署</h3><h5 id="4-1-1-镜像构建"><a href="#4-1-1-镜像构建" class="headerlink" title="4.1.1 镜像构建"></a>4.1.1 镜像构建</h5><p>示例流水线： <a target="_blank" rel="noopener" href="https://cdp.cestc.cn/product/#/project/pipeline/result?projectId=1524581341446340610&pipelineId=1544258747034365954">课程演示-console前端镜像构建</a></p>
<p>点击【执行】，选择参数，【确认】执行</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2.png"></p>
<p>等待构建成功</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E6%9E%84%E5%BB%BA%E6%88%90%E5%8A%9F.png"></p>
<h5 id="4-1-2-第一次部署前端自定义镜像，需要暂停cvo"><a href="#4-1-2-第一次部署前端自定义镜像，需要暂停cvo" class="headerlink" title="* 4.1.2 第一次部署前端自定义镜像，需要暂停cvo"></a>* 4.1.2 第一次部署前端自定义镜像，需要暂停cvo</h5><p>第一次部署时，需要停止cvo。登录到机器上，通过命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oc edit deploy -n openshift-cluster-version cluster-version-operator</span><br></pre></td></tr></table></figure>

<p>将spec.replicas数量改为0即可</p>
<h5 id="4-1-3-部署到环境"><a href="#4-1-3-部署到环境" class="headerlink" title="4.1.3 部署到环境"></a>4.1.3 部署到环境</h5><p>获取镜像地址：</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80.png"></p>
<p>在日志里搜索关键字</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF2-%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%801.png"></p>
<p>打开<a target="_blank" rel="noopener" href="https://console-openshift-console.apps.cc-openshift2.ccos.test/%EF%BC%8C%E4%BF%AE%E6%94%B9%E9%85%8D%E7%BD%AE%EF%BC%8C%E6%9B%B4%E6%96%B0%E5%88%B0%E7%8E%AF%E5%A2%83">https://console-openshift-console.apps.cc-openshift2.ccos.test/，修改配置，更新到环境</a></p>
<p><img src="/./images/%E9%83%A8%E7%BD%B21-0.png"></p>
<p><img src="/./images/%E9%83%A8%E7%BD%B21.png"></p>
<p>等待console的pod销毁重启即可</p>
<p><img src="/./images/%E9%83%A8%E7%BD%B2%E5%AE%8C%E6%88%90.png"></p>
<h3 id="2-UT-amp-E2E"><a href="#2-UT-amp-E2E" class="headerlink" title="2. UT&amp;E2E"></a>2. UT&amp;E2E</h3><p>示例流水线：<a target="_blank" rel="noopener" href="https://cdp.cestc.cn/product/#/project/pipeline/result?projectId=1524581341446340610&pipelineId=1544262047316516865">课程演示-console组件UT和E2E</a></p>
<h4 id="UT成功"><a href="#UT成功" class="headerlink" title="UT成功"></a>UT成功</h4><p>示例：</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF-UT-%E6%88%90%E5%8A%9F.png"></p>
<h4 id="E2E成功"><a href="#E2E成功" class="headerlink" title="E2E成功"></a>E2E成功</h4><p>示例</p>
<p><img src="/./images/4-%E6%B5%81%E6%B0%B4%E7%BA%BF-E2E-%E6%88%90%E5%8A%9F.png"></p>
<h3 id="3-版本测试"><a href="#3-版本测试" class="headerlink" title="3. 版本测试"></a>3. 版本测试</h3><p>略</p>
<h3 id="4-出版本包"><a href="#4-出版本包" class="headerlink" title="4. 出版本包"></a>4. 出版本包</h3><p>略</p>
<h2 id="五、实现效果"><a href="#五、实现效果" class="headerlink" title="五、实现效果"></a>五、实现效果</h2><h3 id="mariadbs列表页"><a href="#mariadbs列表页" class="headerlink" title="mariadbs列表页"></a>mariadbs列表页</h3><p><img src="/./images/demo-list.png"></p>
<h3 id="mariadbs详情页"><a href="#mariadbs详情页" class="headerlink" title="mariadbs详情页"></a>mariadbs详情页</h3><p><img src="/./images/demo-detail-info.png"></p>
<p><img src="/./images/demo-detail-yaml.png"></p>
<h3 id="notification模块"><a href="#notification模块" class="headerlink" title="notification模块"></a>notification模块</h3><p><img src="/./images/demo-notice.png"></p>
<h2 id="六、涉及仓库"><a href="#六、涉及仓库" class="headerlink" title="六、涉及仓库"></a>六、涉及仓库</h2><ul>
<li>编码涉及：<ul>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/cea/ceake-release/-/commit/91f049f3bc1866410feaa86cddef5edd279751af">ceake-release</a></li>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console/-/merge_requests/114/diffs#e615b43a4e596d2e2843c7e99d4b96d025236bf0">console</a></li>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-ceake/-/merge_requests/8/diffs">console-module-ceake</a></li>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-mariadbs/-/tree/feature-lesson-ma">console-module-mariadbs</a></li>
</ul>
</li>
<li>参考：<ul>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/console-module/console-module-demo/-/tree/master">console-module-demo</a></li>
</ul>
</li>
<li>*E2E流水线需要自定义的条件下，需要改动代码：<ul>
<li><a target="_blank" rel="noopener" href="https://code.cestc.cn/ccos/test-repo/-/tree/develop">test-repo</a></li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/08/10/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9D%97-%E9%9D%99%E6%80%81%E6%8F%92%E4%BB%B6/" data-id="cl6n7tlue0002s85w9vx1gxpr" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2022/08/10/%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2022/08/10/CCOS%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83V0.5.1/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">August 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/08/10/%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/10/%E4%BB%8E0%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91%E4%B8%80%E4%B8%AA%E4%B8%9A%E5%8A%A1%E6%A8%A1%E5%9D%97-%E9%9D%99%E6%80%81%E6%8F%92%E4%BB%B6/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/10/CCOS%E6%8E%A7%E5%88%B6%E5%8F%B0%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83V0.5.1/">(no title)</a>
          </li>
        
          <li>
            <a href="/2022/08/09/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>